<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Recursive&display=swap" rel="stylesheet">
  <script src="http://34.200.98.64:3000/scripts/navbar.js"></script>  
  
  <link rel="stylesheet" href="http://34.200.98.64:3000/templates/base.css">
<link rel="stylesheet" href="http://34.200.98.64:3000/templates/prism.css">
<link rel="stylesheet" href="http://34.200.98.64:3000/templates/group.css">  

  <title>The Lucca Logs</title>
</head>
<body>

  <div class="sidebar">    
    <a href="/" class="header"><b>The Lucca Logs</b></a>
    <br>

    <p><a href="/all"><b>All posts</b></a></p>

    <p><a href="/webdesign"><b>Webdesign</b></a></p>

    <p><a href="/programming"><b>Programming</b></a></p>

    <p><a href="/music"><b>Music</b></a></p>

    <p><a href="/album-review"><b>Album reviews</b></a></p>    
      
    <p><a href="/github-readme"><b>GitHub READMEs</b></a></p>

  </div>

  <div class="topbar">
    <div class="title">
      <a href="/"><b>The Lucca Logs</b></a>
    </div>
    <br>
    <div class="button" onclick="toggleMenu()"> 
      <button>ðŸ“„</button>    
    </div>    

  </div>

  <div class="topbar-menu" id="topbar-menu">

    <div class="topbar-menu-item"><a href="/all"><b>All posts</b></a></div>
    
    <div class="topbar-menu-item"><a href="/programming"><b>Programming</b></a></div>
    
    <div class="topbar-menu-item"><a href="/music"><b>Music</b></a></div>
    
    <div class="topbar-menu-item"><a href="/album-review"><b>Album Reviews</b></a></div>
    
    <div class="topbar-menu-item"><a href="/webdesign"><b>Webdesign</b></a></div>
    
    <div class="topbar-menu-item"><a href="/github-readme"><b>GitHub READMEs</b></a></div>
  

  </div>


  <div class="main">        
    <h1 id="group-programming">Group: <em>programming</em></h1>
<hr>
<p><a href="/making-the-website"><em>Read this post in full</em></a></p>
<div class="post"><h1 id="how-i-built-my-personal-website">How I built my personal website</h1>
<hr>
<div class="header"><div class="date">Published on 2021-6-16</div><div class="groups">Groups: <a href="/all">all</a>, <a href="/programming">programming</a>, <a href="/webdesign">webdesign</a></div></div><p><em>This is an updated edition of a post I made a couple of weeks ago, which can be viewed <a href="/old-making-the-website">here</a>.</em></p>
<p>This is a little guide for those who might be interested in knowing how <em>The Lucca Logs</em> was made and my reasoning behind some of the design choices that I made while building this website.</p>
<p>All files and source code for my website are available <a href="https://github.com/ChromeUniverse/Personal-website">here</a>.</p>
<p>Now buckle up, dear reader, because this post is quite a lengthy one. I&#39;ve included a table of contents for your convenience.</p>
<blockquote>
<p><strong>Table of contents</strong></p>
<ol>
<li><a href="#a-brief-introduction">A brief introduction</a></li>
<li><a href="#my-vision">My vision</a>  </li>
<li><a href="#the-solution">The solution</a>  </li>
<li><a href="#creating-posts">Creating posts</a></li>
<li><a href="#templates">Templates</a></li>
<li><a href="#groups">Groups</a></li>
<li><a href="#the-all-powerful-static-webpage-generator">The all-powerful static webpage generator</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ol>
</blockquote>
<h2 id="a-brief-introduction">A brief introduction</h2>
<p>To be perfectly honest, I don&#39;t have any experience at all when it comes to building websites. I&#39;ve never tried services like Squarespace, Wix or Wordpress, and I&#39;ve yet to try using a &quot;real&quot; static website generator like Jekyll or Hugo, but I&#39;ve heard that these tools/services can yield some pretty nice results. In fact, a good friend of mine who&#39;s also a programmer uses Hugo on <a href="https://bykoga.com/">his personal website</a> and it ended up looking very unique and quite spiffy!</p>
<p>But instead of diving straight into learning how to to use some sort of website making tool, I wanted to try building something that was truly my own. I wanted something that had just the right balance of control and expandability. I wanted to build something that I had almost complete control over and that abstracted the least amount of code from me, but at the same time would give me the flexibility to add libraries and additional third-party features as I saw fit. Or in other words, I basically wanted to build my website (both frontend and backend) from scratch.</p>
<p>I have some experience building basic full-stack web applications with <a href="https://nodejs.dev/">Node.js</a>, but no experience so far with frontend libraries like React, Angular or Vue. Naturally I chose Node as my backend and I decided to write all of the frontend stuff in plain HTML, CSS and JavaScript.</p>
<hr>
<h2 id="my-vision">My vision</h2>
<p>Content-wise, I wanted a reasonably simple website for displaying a couple of blog-style posts in which I could talk about anything to my heart&#39;s content: music, coding, science, technology, you name it.</p>
<p>I wanted to build a system that made it ease for me to write new posts without having to mess around with complicated databases, preferably by only creating/editing a single plaintext file. Extra libraries (both frontend and backend) had to be kept to a minimum to reduce complexity. Any extra NPM packages or frameworks better have a really good reason to consume my oh-so-precious kilobytes of AWS network transfer.</p>
<p>And for whoever might be consuming content on this website, I wanted them to be greeted with something that was minimalist in nature to avoid distractions, but still somewhat aesthetically pleasing. I also wanted to build something that made it easy to browse posts and topics easily and quickly, in the case that the reader wished to do so.</p>
<hr>
<h2 id="the-solution">The solution</h2>
<p>To meet these goals, I came up with the following system.</p>
<p>My website uses a custom-built static site generator (<a href="https://www.youtube.com/watch?v=3INXQ_4W42g">What&#39;s that?</a>) which takes in plaintext files with post content and metadata, adds some CSS templates, and generates all of the HTMLs for the website. It&#39;s simple script written in Javascript that runs in Node.js. The files are served by a Node.js + <a href="https://www.npmjs.com/package/express">Express</a> static file webserver. All of the static files and the webserver are hosted on a basic AWS Lightsail instance running Ubuntu 20.04, which costs about $4 USD/month to run. I&#39;ve also set up a CI/CD pipeline with GitHub Actions for automatically building and deploying my website to AWS, which you can read more about <a href="/gh-actions-website">here</a>.</p>
<p><em>Note: I&#39;ll be often referring to the static site generator as a &quot;compiler&quot;, because that&#39;s just the name I chose for the script -</em> &quot;<a href="https://github.com/ChromeUniverse/Personal-website/blob/main/compiler.js"><code>compiler.js</code></a>&quot;.</p>
<p>Even though Express.js is quite a chonky Node.js library, it&#39;s by far the simplest web framework I&#39;ve ever used. It&#39;s ridiculously simple to use, and I love how simple it is to setup Express as a static file server and how easily you can create custom routes. </p>
<p><em><strong>Unpopular opinion/Digression</strong>: Django&#39;s &quot;all batteries included&quot; approach quite honestly <strong>sucks</strong> and is very alienating for beginner web developers, even if you&#39;re an intermediate Python programmer with a couple of years of experience under your belt, like myself. You&#39;ll quickly find yourself constantly switching between a huge amount of additional (read: unnecessary) files, even if all you want to do is setup a minimal webserver with some basic routes. Flask and Express.js did it <strong>way</strong> better - change my mind.</em></p>
<p>As far as the actual posts go, I chose to go with Markdown (.md) files which contain both metadata in YAML and actual text content written in Markdown. The compiler script splits the file in half and parses the YAML with <a href="https://www.npmjs.com/package/js-yaml">JS-YAML</a> to extract the metadata and the actual text with <a href="https://marked.js.org/">Marked.js</a> to convert Markdown into pure HTML, which can be rendered by a web browser.</p>
<p>Markdown makes it super duper easy to write nicely formatted text with headers, section, subsections, links, images, etc. It&#39;s much less cumbersome than raw HTML and writing and formatting text-based content, but since it can&#39;t be rendered by a browser, it needs to be converted to HTML somehow first, which is where Marked.js comes in.</p>
<hr>
<h2 id="creating-posts">Creating posts</h2>
<p>New posts are created by simply creating a new Markdown (.md) file in a specific directory and populating it with: </p>
<ul>
<li><p>a YAML front matter (basically a header with some metadata) in a similar manner to <a href="https://jekyllrb.com/">Jekyll</a> or <a href="https://gohugo.io/">Hugo</a>, with the post&#39;s title, templates, groups and publishing date, like so:</p>
<pre><code class="language-yaml">---
title: Welcome to my webpage!
templates: []
groups: [all, website]
date: 2021-05-27 10:30:00
--- 
</code></pre>
</li>
<li><p>And then, some regular Markdown content:</p>
<pre><code class="language-markdown">Hi, I&#39;m Lucca and this is my personal webpage.

Here you&#39;ll find lots of programming, music, electronics and life shenanigans.

Check the sidebar to the left for essays, posts, project write-ups, interesting/relevant links and more.

Wanna see how this website was built? [Check out the GitHub repo.](https://github.com/ChromeUniverse/personal-website)
</code></pre>
</li>
</ul>
<p>After running the compiler, something like this will be generated, written to an HTML file and will be ready to served by the Node.js webserver:</p>
<p><img src="https://media.discordapp.net/attachments/760252264723644426/848589820125249566/unknown.png" alt="image"></p>
<p>Notice how the title is clearly displayed at the top with a big, readable font and a horizontal line that makes it stand out from the rest of the post. The date in which the post was made and groups in which the post belongs are neatly shown under the horizontal line in unobtrusive italicized text with a gray color.</p>
<p>This system certainly accomplishes the goal of making it really easy to write and update posts, but I think the true beauty comes from the fact that all the information is neatly stored in a single human-readable file.</p>
<hr>
<h2 id="templates">Templates</h2>
<p>The compiler has a basic templating engine as well, in the form of stylesheets and HTML content templates</p>
<p>Templates can be applied to a post by specifying the template file in the <code>templates</code> list in the post&#39;s front matter. The file needs to be located in the <code>/public/templates/</code> directory <em>(check example below)</em>. </p>
<p>By default, two templates called <code>base.html</code> and <code>base.css</code> are included with every single page. Pages for displaying posts in a specific group also include the <code>group.css</code> template (more on that in the &quot;Groups&quot; section below).</p>
<p>I even made a nifty template for fetching GitHub READMEs! You can see it in action for yourself <a href="http://localhost:3000/boxworld">here</a>. Now I don&#39;t have to redo my old project write-ups! ðŸ˜„</p>
<pre><code class="language-yaml">---
templates: [github-fetch.md]
groups: [all, github-readme, me]
github-url: https://github.com/ChromeUniverse/Personal-Website 
date: 2021-05-27 14:33:00
---
</code></pre>
<p>In the example above, the <code>base.html</code>, <code>base.css</code> and <code>github-fetch.md</code> templates will be included with the post.</p>
<hr>
<h2 id="groups">Groups</h2>
<p>&quot;Groups&quot; basically work like tags for the posts.</p>
<p>Posts can be filtered by groups by simply visiting <code>mywebsiteurl.net/group-name</code>, which will display all posts that belong in the group <em>group-name</em>, from newest to oldest. For example, if I wanted to see all posts that belong to the &quot;music&quot; group, I would go to <a href="/music"><code>/music</code></a>.</p>
<p>Groups are assigned to posts by specifying which groups that post should belong to in the <code>groups</code> list in the post&#39;s front matter.</p>
<pre><code class="language-yaml">title: My thoughts on Daft Punk&#39;s _Random Access Memories_
templates: []
groups: [all, album-review, music, daft-punk]
date: 2021-05-27 12:00:00
</code></pre>
<p>The example post above would show up in the <em>all</em>, <em>album-review</em>, <em>music</em> and <em>daft-punk</em> groups.</p>
<hr>
<h2 id="the-all-powerful-static-webpage-generator">The all-powerful static webpage generator</h2>
<p>Okay so obviously, my website generator (a.k.a the &quot;compiler&quot;) is quite limited in what it can do, so it&#39;s pretty damn far from &quot;all-powerful&quot;, but it&#39;s the one doing the heavylifting behind this website. It gets the job done at least, in addition to being easy to maintain and expand on. It&#39;s just a simple Node.js script which I have set up to run using <a href="https://www.npmjs.com/package/nodemon">nodemon</a>. It watches for changes in post and template files and re-runs the compiler on every file save.</p>
<p>This is how it works:</p>
<ul>
<li><p><strong>Content</strong>: First, the generator fetches the post&#39;s actual content. Since it&#39;s still in plain Markdown, it reads the content and parses it with Marked.js to get the raw HTML. </p>
</li>
<li><p><strong>Metadata</strong>: The generator then loads the metadata for a specific post - these would be things like the title, date, and groups. The information in the metadata would be displayed in the page&#39;s header and could also be used by the server to filter posts by groups, sort them by date, etc.</p>
</li>
<li><p><strong>Templates</strong>: The generator loads and applies some base templates in the form of some HTMLs and CSS. It includes whatever additional templates are required for a specific page, such as <a href="https://github.com/ChromeUniverse/Personal-website/blob/main/public/templates/group.css"><code>groups.css</code></a> for group pages and <a href="https://github.com/ChromeUniverse/Personal-website/blob/main/public/templates/github-fetch.md"><code>github-fetch.md</code></a> for GitHub README posts.</p>
</li>
<li><p><strong>Write to HTML file</strong>: Finally, the server bundles it all up and writes it to an HTML file, which can be served by the Node.js webserver.</p>
</li>
</ul>
<hr>
<h2 id="conclusion">Conclusion</h2>
<p>Writing these posts and building the infrastructure for this website have both been very time-consuming and quite the adventure, but honestly, I think I&#39;ve done a pretty acceptable job, regarding the quality of both the actual content and the underlying programming. Creating and editing new posts is now an effortless process, group pages are generated automatically by the compiler, and my automated integration and deployment pipeline is working flawlessly. I&#39;ve also grown quite fond of Markdown and YAML during the making of this project.</p>
<p>I truly believe my current setup for maintaining this website is a viable solution for a personal blog-style website such as my own. And no, I don&#39;t mean it&#39;s complete by any stretch of the imagination - there&#39;s still a lot of work to do and loads of features to add. But I&#39;m certain it has the potential to create websites which are aesthetically pleasing and minimalist in nature, yet still very functional and expandable.</p>
<p>Hopefully people can see what this system is capable of and will adapt it to their own use cases, or at least learn a thing or two from my ongoing <a href="/webdesign">webdesign adventures</a>.</p>
<p>And it turns out that this project also helped me learn that I actually really enjoy writing! This project was a surprisingly enjoyable way to combine my programming skills with writing, and I never thought creating a personal blog could be this fun. I can totally see myself writing posts for the remainder of this year, at least.</p>
<p>For the time being, this is all I have to share about my website. If you&#39;ve made it this far, thank you soooo much for reading this - I&#39;ve put a lot of effort into making all of what you see right now. </p>
<p>Have a good one! Lucca out. ðŸ‘‹</p>
</div><p><a href="/gh-actions-website"><em>Read this post in full</em></a></p>
<div class="post"><h1 id="github-actions---automation-galore">GitHub Actions - automation galore!</h1>
<hr>
<div class="header"><div class="date">Published on 2021-6-14</div><div class="groups">Groups: <a href="/all">all</a>, <a href="/programming">programming</a>, <a href="/devops">devops</a>, <a href="/webdesign">webdesign</a></div></div><p><strong><em>This post is a work in progress!</em></strong></p>
<p>...</p>
<p>I&#39;ve finally gotten around to using GitHub actions for the first time, and boy, can it automate the living crap out of building, testing and deployment. In fact, I&#39;ve updated this website&#39;s <a href="https://github.com/ChromeUniverse/Personal-website">GitHub repo</a> with a custom workflow built around GitHub Actions to automate static file generation and deployment of my website. It&#39;s a really useful tool that you might be interested in using for web app development.</p>
<h2 id="github-actions-basics"><a href="https://github.com/features/actions">GitHub Actions</a> basics</h2>
<p>Actions is a relatively new feature on GitHub that lets you automate software <em>workflows</em> (such as build, testing, code review, deployment, merging code from different branches, metric tracking, etc.) that are triggered when a certain event happens in your GitHub repo (push to a <code>main</code> branch, submitted pull request, merge, <code>cron</code> schedule, new release, etc.). </p>
<p>You create workflows by writing a YAML file that specifies the jobs that you want to run and what event will trigger those jobs to run. A simple workflow for a building a Node.js app would look something like this:</p>
<pre><code class="language-yaml">name: Node.js CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:

    runs-on: ubuntu-latest

    strategy:
      matrix:
        node-version: [10.x, 12.x, 14.x, 15.x]

    steps:
      - uses: actions/checkout@v2
      - name: Use Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v1
        with:
          node-version: ${{ matrix.node-version }}
      - run: npm ci
      - run: npm run build --if-present
      - run: npm test
</code></pre>
<p>Notice how the <a href="https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions">syntax</a> for these workflow files is quite human-readable and reasonably simple to understand, even if you don&#39;t have any prior experience with Actions.</p>
<p>I&#39;m not going into too much detail about what the workflow above does - for that, you can read <a href="https://www.freecodecamp.org/news/what-are-github-actions-and-how-can-you-automate-tests-and-slack-notifications/">this great tutorial</a> from freeCodeCamp for a step-by-step breakdown - instead, I&#39;d like to use this post to describe a practical use case for GitHub Actions and how I set up an automated build/deploy workflow for the website that you&#39;re using right now to read this article.</p>
<hr>
<h2 id="actions-workflow-for-my-personal-website">Actions workflow for my personal website</h2>
<p>I set up Actions to automate the webpage compilation process and deployment of this website. My full workflow file is available <a href="https://github.com/ChromeUniverse/Personal-website/blob/main/.github/workflows/compile-deploy.yaml">here</a>. </p>
<pre><code class="language-yaml"># name of the workflow
name: Build and deploy website

on: 
  # events that trigger workflow

jobs:

  # compile webpages 
  build:
    runs-on: ubuntu-latest
    steps:
    # steps/commands to run

  # deploy website to AWS Lightsail
  deploy:    
    needs: build
    runs-on: ubuntu-latest
    steps:
    # steps/commands to run
</code></pre>
<p>Here&#39;s what my workflow is basically doing:</p>
<ol>
<li><p>It&#39;s triggered by pushes to the <code>main</code> or <code>test</code> branches</p>
</li>
<li><p>It compiles the webpages by running <a href="https://github.com/ChromeUniverse/Personal-website/blob/main/compiler.jss">this script</a> and generates the website&#39;s HTMLs</p>
</li>
<li><p>Commits and pushes the HTMLs back to the remote repo</p>
</li>
<li><p>Logs in to a remote AWS Lightsail server using SSH (yes, surprisingly, it is possible to use Actions to log in to remote hosts)</p>
</li>
<li><p>Runs an update script on the server which pulls changes from the remote repo and restarts the Node.js server with <a href="https://www.npmjs.com/package/pm2">pm2</a></p>
</li>
</ol>
<p>Let&#39;s breakdown these steps:</p>
<h3 id="1-events">1. Events</h3>
<p>This is basically as simple as it gets when it comes to <a href="https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions#on">events</a>. Events are specified with the <code>on:</code> keyword. My workflow starts running when pushes are made to either the <code>main</code> or <code>test</code> branches.</p>
<pre><code class="language-yaml">on: 
  push:
    branches: 
      # Main branch
      - main
      # Testing branch
      - test
</code></pre>
<h3 id="2-webpage-compilation">2. Webpage compilation</h3>
<p>My webpage compiler is a JS script which takes my Markdown-formatted posts, fetches some HTML and CSS templates, and converts them to HTMLs ready to be served by my main webserver. It needs Node.js and a couple of dependencies to run - thankfully, there&#39;s already a specific action for installing Node and NPM with GitHub actions, <a href="https://github.com/actions/setup-node">setup-node</a>.</p>
<p>Both the compiler and Git commit/pushes run on the <code>build</code> job.</p>
<p>A couple of quick notes on jobs:</p>
<ul>
<li><p>You need to specify the operating system that each job will run on. I always choose Ubuntu Linux for simplicity&#39;s sake.</p>
</li>
<li><p>If your job needs to access your source code (for running tests, compiling, building, etc.), you&#39;ll need to use the <a href="https://github.com/actions/checkout"><code>checkout</code></a> action to get your code into the workflow runner.</p>
</li>
<li><p>Each job has a sequence of tasks called <code>steps</code>. Each <code>step</code> can have only one <code>run</code> statement, but you can run always run multiple commands by using <code>run: |</code> and a sequence of commands, with one command per line.</p>
</li>
</ul>
<pre><code class="language-yaml"># compile webpages 
build:

  runs-on: ubuntu-latest

  steps:

  # Check out code
  - uses: actions/checkout@v2

  # Node.js setup
  - name: Setting up Node.js!
    uses: actions/setup-node@v1    
    with:
      node-version: 14.x

  # Install packages with NPM
  - name: Install dependencies
    run: npm ci

  # Compile webpages
  - name: Compile all webpages
    # NOTE: specify server address - in this case, it&#39;s 34.200.98.64:3000
    run: node compiler.js 34.200.98.64:3000
</code></pre>
<p>In the workflow snippet above, I&#39;ve told the runner to install Node.js version 14, install my NPM packages with <code>npm ci</code>, and run my webpage compiler with the address of this webpage as an argument (I&#39;ve added this feature to make it easier to compile webpages for both local development and deployment).</p>
<h3 id="3-git-commits-user-config-and-pushes">3. Git commits, user config, and pushes</h3>
<p>The following steps are run in the same <code>build</code> job as before:</p>
<pre><code class="language-yaml">jobs:

  # compile webpages 
  build:

    runs-on: ubuntu-latest

    steps:

    # ...
    # compiler steps
    # ...

    # List file changes
    - name: Log file changes
      run: git status

    # Stage all changes
    - name: Stage all files
      run: git add .

    # Push Config
    - name: Git config
      run: | 
        git config --global user.name &#39;MY_GITHUB_USERNAME&#39; 
        git config --global user.email &#39;MY_EMAIL&#39;
    
    # Commit changes
    - name: Commit and push changes
      # run commit bash script
      run: |
        chmod +x commit-push.sh
        ./commit-push.sh

  # end of `build` job
</code></pre>
<p>After running the compiler, the workflow stages all files, configures the local Git repo with my personal GitHub credentials, and runs a Bash script. It tries to commit the files, and if the commit is successful, it pushes the files to the remote repo. </p>
<p>I was having some issues where the workflow would fail if there were no changes in the files, since <code>git commit</code> only exits with code 0 if there are files with untracked changes. This simple Bash script fixes that issue:</p>
<pre><code class="language-bash">#!/bin/bash
# Check if there are changes to commit

# Try committing changes
git commit -m &quot;* Automated webpage compilation *&quot;

# Check exit code
if [ $? -eq 0 ]; 
then
  # Commit sucessful - go ahead and push
  echo &quot;Commited all changes&quot;
  git push origin main
else
  # Probably no changes to commit - ignore and exit
  # $DEPLOY=false
  echo &quot;No changes to commit!&quot;
fi

exit 0
</code></pre>
<h3 id="4-creating-an-ssh-identity-file">4. Creating an SSH identity file</h3>
<p>Since I couldn&#39;t find any specific actions for deploying to AWS Lightsail (my VPS of choice), I chose to deploy my website the hard way: use SSH to log in to my Lightsail instance and then run whatever commands I need to on the remote host. All of this SSH stuff is handled in the <code>deploy</code> job. </p>
<p>The really cool thing about doing it &quot;the hard way&quot; is that you can use it for deploying code to just about any VPS and any cloud service provider, not just AWS&#39; Lightsail or EC2 machines. You could most certainly use this same approach for VPSes from Linode, GCP, Azure, Digital Ocean or even a self-hosted server of your own, like a Raspberry Pi 4.</p>
<p>I originally discovered about this method in <a href="https://blog.bugout.dev/2020/06/19/using-github-actions-to-deploy-to-aws-lightsail/">this post</a> by Neeraj Kashyap of the <a href="https://blog.bugout.dev/">bugout.dev</a> blog. In the article, he mentions this <a href="https://www.linode.com/docs/guides/use-public-key-authentication-with-ssh">great guide</a> by Linode <strong>(which you should definitely read ASAP)</strong> on how to properly generate and setup SSH public/private key pairs with <code>ssh-keygen</code>.</p>
<p>In short, after generating your SSH private key, you&#39;ll encode it with Base64 and <a href="https://docs.github.com/en/actions/reference/encrypted-secrets#creating-encrypted-secrets-for-a-repository">store the encoded key as a <em>secret</em> in your GitHub repository</a> (read below for more on secrets). On Mac/Linux, you can use the <code>base64</code> command to encode your private SSH key - chances are it&#39;s called <code>id_rsa</code>. Be sure to use <code>-w0</code> to remove line breaks:</p>
<pre><code class="language-sh">lucca@ThinkBook-13s:~$ base64 -w0 ~/.ssh/id_rsa
</code></pre>
<p><a href="https://docs.github.com/en/actions/reference/encrypted-secrets">Secrets</a> are super handy for hiding oh-so-precious auth tokens for APIs and Discord bots, SSH keys, credentials such as username/password combinations and other sensitive data. Your workflow can fetch the secret, decode it and use it to generate an identity file on the runner to use it as a private key for SSH login.</p>
<p>Some additional notes:</p>
<ul>
<li><p>Since jobs in a workflow run in parallel by default, you&#39;ll need to use the <code>needs:</code> keyword to specify the other jobs that should before the current one.</p>
</li>
<li><p>You&#39;ll need to use <code>chmod</code> to make the identify file readable by the root user, at least - something like <code>chmod 400</code> should work just fine.</p>
</li>
</ul>
<pre><code class="language-yaml">jobs:
 
  build:
  # ...

  # deploy website to AWS Lightsail
  deploy:    

    # only run after &quot;build&quot; job is complete
    needs: build

    runs-on: ubuntu-latest

    steps:

    # Creating SSH private key
    - name: Create identity file

      # Get BASE64-encoded private key stored in secret
      env:        
        DEPLOYMENTKEY: ${{ secrets.DEPLOYKEY }}

      # Decode with BASE64, change permissions with chmod        
      run: | 
        echo &quot;$DEPLOYMENTKEY&quot; | base64 --decode  &gt;deployment.key
        chmod 400 deployment.key

    # SSH into AWS Lightsail
    - name: SSH Login + Update

      # Login with deployment.key, run bash script 
      run: |
        ssh -v -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -i deployment.key ubuntu@34.200.98.64 /home/ubuntu/Personal-website/update.sh
</code></pre>
<h3 id="5-running-the-update-script">5. Running the update script</h3>
<p>Run the update script over SSH:</p>
<pre><code class="language-sh">ssh -v -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -i deployment.key ubuntu@34.200.98.64 /home/ubuntu/Personal-website/update.sh
</code></pre>
</div><p><a href="/prism-testing"><em>Read this post in full</em></a></p>
<div class="post"><h1 id="trying-out-prismjs">Trying out Prism.js</h1>
<hr>
<div class="header"><div class="date">Published on 2021-5-30</div><div class="groups">Groups: <a href="/all">all</a>, <a href="/programming">programming</a>, <a href="/webdesign">webdesign</a></div></div><p>I&#39;ve just added a new library to my website, <a href="https://prismjs.com/">Prism.js</a>, for improved code snippets. </p>
<p>Since my posts often place a heavy emphasis on coding, I figured that having quality code snippets with adequate syntax highlighting (among other things) will add a lot of value to my programming-related posts. </p>
<p>And from the looks of it, Prism is working pretty well. Just to demonstrate, here are a couple of example code snippets.</p>
<p>The first example code snippet is a small part of the main <code>bot.py</code> file from my <a href="https://github.com/ChromeUniverse/RedstoneBot">RedstoneBot</a> project, written in Python.</p>
<pre><code class="language-python"># module imports
import asyncio
import aiohttp
import discord
from discord.ext import commands

# function imports from files
from login import login
from format_help import format_help
from get_status import get_status
from get_times import get_times
from activate import activate
from deactivate import deactivate
from reactivate import reactivate
from register import register
from leave_queue import leave_queue
from unregister import unregister
from get_list import get_list

# member role functions
from role_functions import (
    check_user,
    check_admin,
)

# database functions
from db_functions import (
    link,
    guild_in_db,
    IP_in_db,
    get_serverID,
    get_looping,
    update_looping,
    deleteEntry,
)

# credentials
from credentials import (
    username,
    password,
    token,
)

# -----------------------------------------------------------------
# Discord setup
# -----------------------------------------------------------------



# command prefix
client = commands.Bot(command_prefix = &#39;!redstone &#39;)

# Redstone dust reddish color for Rich Embeds
redstoneRed = discord.Colour.from_rgb(221,55,55)

# removing default Help command
client.remove_command(&#39;help&#39;)

# bot startup
@client.event
async def on_ready():
    # retrieving aiohttp ClientSession
    global session_list
    session = session_list[0]

    # logging in to ploudos.com
    login_status_code = await login(username, password, session)
    print(&#39;\nLogin status code: &#39; + str(login_status_code))

    print(&#39;Bot is ready to roll!\n&#39;)



# -----------------------------------------------------------------
# Discord commands
# -----------------------------------------------------------------


# help command - shows useful help page w/ commands + other things
@client.command()
async def help(ctx):

    title, content = format_help()
    # format and send rich embed
    page=discord.Embed(
        title=title,
        description=content,
        colour=redstoneRed
    )
    await ctx.send(embed=page)





# ping command - replies with &quot;Pong!&quot; + connection latency in miliseconds
@client.command()
async def ping(ctx):
    await ctx.send(f&#39;Pong! :ping_pong: Connection latency is {round(client.latency * 1000)}ms&#39;)
</code></pre>
<p>For the second example, I&#39;ll try a code snippet in C++. This is a <a href="https://en.wikipedia.org/wiki/Reverse_Polish_notation">Reverse Polish Notation</a> parser and evaluator that I wrote a couple of months ago with the help of my friend <a href="https://github.com/qrno">Eduardo Quirino</a>.</p>
<pre><code class="language-c++">/*
    -- RPN Parser --

    Parses and evaluates reverse polish
    notation expressions.

*/


#include &lt;iostream&gt; // input/output
#include &lt;typeinfo&gt;
#include &lt;stack&gt;    // stack data structure
#include &lt;queue&gt;
#include &lt;math.h&gt;   // quick maths
#include &lt;string&gt;   // guess what this does?
#include &lt;sstream&gt;  // stringstreams

#include &lt;vector&gt;

using namespace std;


/*
numberStack.push(5); -&gt; puts element into stack
numberStack.pop();   -&gt; removes top element
numberStack.top();   -&gt; gets top element

numberStack.size()   -&gt; number of elements
numberStack.empty()  -&gt; [BOOL] whether it is emtpy
*/




// Returns whether string is a number
bool isNumber(string s) {
  // looping over chars in string

  // checking for empty input
  if (s.size() == 0) return false;

  for (int i = 0; i &lt; s.size(); i++) {
    char letter = s[i];

    // check if letter isn&#39;t digit or decimal point
    if (letter &lt; &#39;0&#39; || letter &gt; &#39;9&#39;) {
      // checks minus case
      if ((letter == &#39;-&#39; &amp;&amp; i == 0) &amp;&amp; s.size() &gt; 1)
        continue;
      // checks decimal point case
      if (letter == &#39;.&#39;) continue;

      return false;
    }
  }
  // found an actual number
  return true;
}





// Splits expression into queue
queue&lt;string&gt; string2queue(string expression) {
  queue&lt;string&gt; token_queue;
  /*
  token_queue.push(3)   -&gt; enqueues element
  token_queue.pop()     -&gt; dequeues element
  token_queue.front()   -&gt; gets first element
  */

  // empty string token
  string token = &quot;&quot;;

  // iterating through expression
  for (int i = 0; i &lt; expression.size(); i++) {
    char letter = expression[i];

    // adding letter to token
    if (letter != &#39; &#39;) token += letter;
    else {      // found a whitespace char
      if (!token.empty()) { // protects against multiple whitespaces
        // ready to push token to queue
        token_queue.push(token);
        //cout &lt;&lt; &quot;This is token, right here: &quot; &lt;&lt; token &lt;&lt; endl;
        token=&quot;&quot;;
      } // else, just another whitespace, keep going
    }
  }
  // adds token at the end of the expression (edge case)
  if ( !token.empty() ) token_queue.push(token);

  return token_queue;
}




// print elements in a queue
void print_queue(queue&lt;string&gt; q){
  int i = 0;
  while (!q.empty())
  {
    cout &lt;&lt; i &lt;&lt; &quot;-th element: &quot; &lt;&lt; q.front() &lt;&lt; endl;
    q.pop();
    i++;
  }
  cout &lt;&lt; endl;
}




// evaluate RPN expression
double solve(string expression) {

  // generating queue of tokens
  queue&lt;string&gt; token_queue = string2queue(expression);

  /*
  // print copy of token_queue
  queue&lt;string&gt; q_copy = token_queue;
  print_queue(q_copy);
  */


  // big &#39;ol stack of numbers
  stack&lt;double&gt; numberStack;

  while (!token_queue.empty()) {
    // getting the token at the front of the queue
    string token = token_queue.front();
    token_queue.pop();

    // checking if token is a number
    if (isNumber(token)) {
      //cout &lt;&lt; token &lt;&lt; &quot; is number\n&quot;;

      // Converting string token to double
      double numToken = stod(token);
      // pushing number to stack
      numberStack.push(numToken);
    } else {
      // found an operator
      if (numberStack.size() &lt; 2) {
        cout &lt;&lt; &quot;SYNTAX ERROR - Not enough numbers in stack\n&quot;;
        exit(1);
      }

      // getting and popping the RH operand
      //cout &lt;&lt; numberStack.top() &lt;&lt; &quot; is a: &quot; &lt;&lt; typeid(numberStack.top()).name() &lt;&lt; endl;
      double b = numberStack.top() + 0.0;
      numberStack.pop();
      //cout &lt;&lt; b &lt;&lt; &quot; is: &quot; &lt;&lt; typeid(b).name() &lt;&lt; endl;
      // getting and popping the LH operand
      //cout &lt;&lt; numberStack.top() &lt;&lt; &quot; is a: &quot; &lt;&lt; typeid(numberStack.top()).name() &lt;&lt; endl;
      double a = numberStack.top() + 0.0;
      numberStack.pop();
      //cout &lt;&lt; a &lt;&lt; &quot; is: &quot; &lt;&lt; typeid(a).name() &lt;&lt; endl;

      // operation result
      double result = 0;

      // executing operation
      if (token == &quot;+&quot;) result = a + b;           // addition
      else if (token == &quot;-&quot;) result = a - b;      // subtraction
      else if (token == &quot;*&quot;) result = a * b;      // multiplication
      else if (token == &quot;/&quot;) result = a / b;      // division
      else if (token == &quot;^&quot;) result = pow(a, b);  // exponentiation
      // checking for invalid operators
      else {
        cout &lt;&lt; &quot;INVALID INPUT - This operator doesn&#39;t exist\n&quot;;
        exit(1);
      }

      // pushing result to number stack
      numberStack.push(result);
    }
  }

  // cheking the size of the number stack
  int stackSize = numberStack.size();

  // If we got anything other than one, something went wrong.
  if (stackSize != 1) {
    cout &lt;&lt; &quot;SYNTAX ERROR - Not enough operators\n&quot;;
    exit(1);
  }

  // Pop result and print it
  double result = numberStack.top();
  numberStack.pop();

  return result;
}





// list of test expressions &amp; expected output
vector&lt; pair&lt;string, double&gt; &gt; tests{
  /*1*/{&quot;2 3 +&quot;, 5},
  /*2*/{&quot;2 3 *&quot;, 6},
  /*3*/{&quot;-123123 -123123 +&quot;, -246246},
  /*4*/{&quot;2 2 + 3 - 123 - 24 *&quot;, -2928},
  /*5*/{&quot;5 3 + 7 15 * 8 + -&quot;, -105},
  /*6*/{&quot;2.00 3.99 +&quot;, 5.99},
  /*7*/{&quot;4.00 2.00 /&quot;, 2.00},
  /*8*/{&quot;2.0 5.0 ^&quot;, 32.0},
};





// run test expressions
bool runTests() {
  bool success = true;

  // looping through tests
  for (auto test : tests) {
    // solve expression
    double result = solve(test.first);

    // comparing solve() output with expected output
    if (result != test.second) {
      // current test failed
      cout &lt;&lt; &quot;FAILED TEST &quot; &lt;&lt; test.first &lt;&lt; endl;
      cout &lt;&lt; &quot;EXPECTED &quot; &lt;&lt; test.second &lt;&lt; &quot; GOT &quot; &lt;&lt; result &lt;&lt; endl;
      success = false;
    }
  }
  return success;
}






// main program function
int main() {

  // run test expressions
  bool success = runTests();
  if (success) cout &lt;&lt; &quot;SUCCESS!&quot;;


  string expression;

  // read RPN expression
  cout &lt;&lt; &quot;Enter RPN: &quot;;
  getline(cin, expression);

  // evaluate expression
  double result = solve(expression);

  // print output
  cout &lt;&lt; result &lt;&lt; endl;
  

  return 0;
}
</code></pre>
<p>Finally, I&#39;m going to try out some Javascript. This is the classic memoized Fibonacci sequence program in JS:</p>
<pre><code class="language-js">var fibList = [];

function fib(num) {
  if (num == 1 || num == 2) {
    return 1;
  } else {
    return fib(num-1) + fib(num-2);
  }
}

function main(num){
  console.log(&quot;The first &quot; + num + &quot;Fibonacci numbers are: &quot;);
  for (var i = 1; i &lt; num+1; i++) {
    fibNum = fib(i);
    console.log(&quot;Fib number &quot; + i + &quot;: &quot; + fibNum);
  }
}

main(50);
</code></pre>
<p>Yep, Prism.js is definetely working as advertised. ðŸ˜ƒ</p>
<p>Expect to see it used quite regularly in my future posts.</p>
</div><p><a href="/tank-battle"><em>Read this post in full</em></a></p>
<div class="post"><p id="ChromeUniverse/Tank-Battle/">
  I hope you haven't disabled JavaScript on this page, or else this won't work ðŸ˜¬
</p>
<hr>
<p id="notice">
  The above text was automatically fetched from <a id="https://github.com/ChromeUniverse/Tank-Battle/" href="https://www.youtube.com/watch?v=dQw4w9WgXcQ">this GitHub repo</a> using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Fetch API</a> and converted to HTML with <a href="https://marked.js.org/">Marked.js</a>. Pretty cool, right? ðŸ˜‰
</p>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>
  mini = 'ChromeUniverse/Tank-Battle/';
  console.log('Trying to fetch from', mini);
  fetch("https://raw.githubusercontent.com/" + mini + "/main/README.md")
    .then(response => {
      response.text().then(text => {
        console.log(text);
        document.getElementById("ChromeUniverse/Tank-Battle/").innerHTML = marked(text);          
      })        
    }
  );
  document.getElementById("https://github.com/ChromeUniverse/Tank-Battle/").href = 'https://github.com/ChromeUniverse/Tank-Battle/';
</script>




</div><p><a href="/redstone"><em>Read this post in full</em></a></p>
<div class="post"><p id="ChromeUniverse/RedstoneBot/">
  I hope you haven't disabled JavaScript on this page, or else this won't work ðŸ˜¬
</p>
<hr>
<p id="notice">
  The above text was automatically fetched from <a id="https://github.com/ChromeUniverse/RedstoneBot/" href="https://www.youtube.com/watch?v=dQw4w9WgXcQ">this GitHub repo</a> using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Fetch API</a> and converted to HTML with <a href="https://marked.js.org/">Marked.js</a>. Pretty cool, right? ðŸ˜‰
</p>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>
  mini = 'ChromeUniverse/RedstoneBot/';
  console.log('Trying to fetch from', mini);
  fetch("https://raw.githubusercontent.com/" + mini + "/main/README.md")
    .then(response => {
      response.text().then(text => {
        console.log(text);
        document.getElementById("ChromeUniverse/RedstoneBot/").innerHTML = marked(text);          
      })        
    }
  );
  document.getElementById("https://github.com/ChromeUniverse/RedstoneBot/").href = 'https://github.com/ChromeUniverse/RedstoneBot/';
</script>




</div><p><a href="/boxworld"><em>Read this post in full</em></a></p>
<div class="post"><p id="ChromeUniverse/The-Box-World/">
  I hope you haven't disabled JavaScript on this page, or else this won't work ðŸ˜¬
</p>
<hr>
<p id="notice">
  The above text was automatically fetched from <a id="https://github.com/ChromeUniverse/The-Box-World/" href="https://www.youtube.com/watch?v=dQw4w9WgXcQ">this GitHub repo</a> using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Fetch API</a> and converted to HTML with <a href="https://marked.js.org/">Marked.js</a>. Pretty cool, right? ðŸ˜‰
</p>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>
  mini = 'ChromeUniverse/The-Box-World/';
  console.log('Trying to fetch from', mini);
  fetch("https://raw.githubusercontent.com/" + mini + "/main/README.md")
    .then(response => {
      response.text().then(text => {
        console.log(text);
        document.getElementById("ChromeUniverse/The-Box-World/").innerHTML = marked(text);          
      })        
    }
  );
  document.getElementById("https://github.com/ChromeUniverse/The-Box-World/").href = 'https://github.com/ChromeUniverse/The-Box-World/';
</script>




</div>
    <hr>
    <footer>Â© Lucca Rodrigues 2021</footer>    
    <footer><a href="https://github.com/ChromeUniverse">GitHub</a> â€¢ <a href="https://www.linkedin.com/in/lucca-rodrigues-61b8271b3/">LinkedIn</a> â€¢ <a href="https://www.youtube.com/channel/UCjpQ2w6Di2f-tyCiK6mVGlA">YouTube</a></footer>
    
  </div>

  <script src="http://34.200.98.64:3000//scripts/prism.js"></script>
</body>
</html>